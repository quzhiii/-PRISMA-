<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="æ–‡çŒ®ç­›é€‰å’ŒPRISMA 2020æµç¨‹å›¾ç”Ÿæˆå·¥å…· - æ”¯æŒå¤šæ ¼å¼å¯¼å…¥ã€æ™ºèƒ½å»é‡ã€çµæ´»ç­›é€‰è§„åˆ™ã€3ä¸‡ç¯‡å¤§è§„æ¨¡å¤„ç†">
  <meta name="keywords" content="æ–‡çŒ®ç­›é€‰,PRISMAæµç¨‹å›¾,ç³»ç»Ÿç»¼è¿°,èŸèƒåˆ†æ,Metaåˆ†æ,å¤§è§„æ¨¡å¤„ç†">
  <title>PRISMAæ–‡çŒ®ç­›é€‰åŠ©æ‰‹ v1.7</title>
  <style>
    :root {
  /* Primitive Color Tokens */
  --color-white: rgba(255, 255, 255, 1);
  --color-black: rgba(0, 0, 0, 1);
  --color-cream-50: rgba(252, 252, 249, 1);
  --color-cream-100: rgba(255, 255, 253, 1);
  --color-gray-200: rgba(245, 245, 245, 1);
  --color-gray-300: rgba(167, 169, 169, 1);
  --color-gray-400: rgba(119, 124, 124, 1);
  --color-slate-500: rgba(98, 108, 113, 1);
  --color-brown-600: rgba(94, 82, 64, 1);
  --color-charcoal-700: rgba(31, 33, 33, 1);
  --color-charcoal-800: rgba(38, 40, 40, 1);
  --color-slate-900: rgba(19, 52, 59, 1);
  --color-teal-300: rgba(50, 184, 198, 1);
  --color-teal-400: rgba(45, 166, 178, 1);
  --color-teal-500: rgba(33, 128, 141, 1);
  --color-teal-600: rgba(29, 116, 128, 1);
  --color-teal-700: rgba(26, 104, 115, 1);
  --color-teal-800: rgba(41, 150, 161, 1);
  --color-red-400: rgba(255, 84, 89, 1);
  --color-red-500: rgba(192, 21, 47, 1);
  --color-orange-400: rgba(230, 129, 97, 1);
  --color-orange-500: rgba(168, 75, 47, 1);

  --color-brown-600-rgb: 94, 82, 64;
  --color-teal-500-rgb: 33, 128, 141;
  --color-slate-900-rgb: 19, 52, 59;
  --color-slate-500-rgb: 98, 108, 113;
  --color-red-500-rgb: 192, 21, 47;
  --color-red-400-rgb: 255, 84, 89;
  --color-orange-500-rgb: 168, 75, 47;
  --color-orange-400-rgb: 230, 129, 97;

  --color-bg-1: rgba(59, 130, 246, 0.08);
  --color-bg-2: rgba(245, 158, 11, 0.08);
  --color-bg-3: rgba(34, 197, 94, 0.08);
  --color-bg-4: rgba(239, 68, 68, 0.08);
  --color-bg-5: rgba(147, 51, 234, 0.08);
  --color-bg-6: rgba(249, 115, 22, 0.08);
  --color-bg-7: rgba(236, 72, 153, 0.08);
  --color-bg-8: rgba(6, 182, 212, 0.08);

  --color-background: var(--color-cream-50);
  --color-surface: var(--color-cream-100);
  --color-text: var(--color-slate-900);
  --color-text-secondary: var(--color-slate-500);
  --color-primary: var(--color-teal-500);
  --color-primary-hover: var(--color-teal-600);
  --color-primary-active: var(--color-teal-700);
  --color-secondary: rgba(var(--color-brown-600-rgb), 0.12);
  --color-secondary-hover: rgba(var(--color-brown-600-rgb), 0.2);
  --color-secondary-active: rgba(var(--color-brown-600-rgb), 0.25);
  --color-border: rgba(var(--color-brown-600-rgb), 0.2);
  --color-btn-primary-text: var(--color-cream-50);
  --color-card-border: rgba(var(--color-brown-600-rgb), 0.12);
  --color-card-border-inner: rgba(var(--color-brown-600-rgb), 0.12);
  --color-error: var(--color-red-500);
  --color-success: var(--color-teal-500);
  --color-warning: var(--color-orange-500);
  --color-info: var(--color-slate-500);
  --color-focus-ring: rgba(var(--color-teal-500-rgb), 0.4);
  --color-select-caret: rgba(var(--color-slate-900-rgb), 0.8);

  --focus-ring: 0 0 0 3px var(--color-focus-ring);
  --focus-outline: 2px solid var(--color-primary);

  --font-family-base: "FKGroteskNeue", "Geist", "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
  --font-size-xs: 11px;
  --font-size-sm: 12px;
  --font-size-base: 14px;
  --font-size-md: 14px;
  --font-size-lg: 16px;
  --font-size-xl: 18px;
  --font-size-2xl: 20px;
  --font-size-3xl: 24px;
  --font-size-4xl: 30px;
  --font-weight-normal: 400;
  --font-weight-medium: 500;
  --font-weight-semibold: 550;
  --font-weight-bold: 600;
  --line-height-tight: 1.2;
  --line-height-normal: 1.5;

  --space-4: 4px;
  --space-8: 8px;
  --space-12: 12px;
  --space-16: 16px;
  --space-20: 20px;
  --space-24: 24px;
  --space-32: 32px;

  --radius-sm: 6px;
  --radius-base: 8px;
  --radius-md: 10px;
  --radius-lg: 12px;
  --radius-full: 9999px;

  --shadow-xs: 0 1px 2px rgba(0, 0, 0, 0.02);
  --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.04), 0 1px 2px rgba(0, 0, 0, 0.02);
  --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.04), 0 2px 4px -1px rgba(0, 0, 0, 0.02);
  --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.04), 0 4px 6px -2px rgba(0, 0, 0, 0.02);

  --duration-fast: 150ms;
  --duration-normal: 250ms;
  --ease-standard: cubic-bezier(0.16, 1, 0.3, 1);
}

@media (prefers-color-scheme: dark) {
  :root {
    --color-gray-400-rgb: 119, 124, 124;
    --color-teal-300-rgb: 50, 184, 198;
    --color-gray-300-rgb: 167, 169, 169;
    --color-gray-200-rgb: 245, 245, 245;

    --color-bg-1: rgba(29, 78, 216, 0.15);
    --color-bg-2: rgba(180, 83, 9, 0.15);
    --color-bg-3: rgba(21, 128, 61, 0.15);
    --color-bg-4: rgba(185, 28, 28, 0.15);
    --color-bg-5: rgba(107, 33, 168, 0.15);
    --color-bg-6: rgba(194, 65, 12, 0.15);
    --color-bg-7: rgba(190, 24, 93, 0.15);
    --color-bg-8: rgba(8, 145, 178, 0.15);

    --color-background: var(--color-charcoal-700);
    --color-surface: var(--color-charcoal-800);
    --color-text: var(--color-gray-200);
    --color-text-secondary: rgba(var(--color-gray-300-rgb), 0.7);
    --color-primary: var(--color-teal-300);
    --color-primary-hover: var(--color-teal-400);
    --color-primary-active: var(--color-teal-800);
    --color-secondary: rgba(var(--color-gray-400-rgb), 0.15);
    --color-secondary-hover: rgba(var(--color-gray-400-rgb), 0.25);
    --color-secondary-active: rgba(var(--color-gray-400-rgb), 0.3);
    --color-border: rgba(var(--color-gray-400-rgb), 0.3);
    --color-error: var(--color-red-400);
    --color-success: var(--color-teal-300);
    --color-warning: var(--color-orange-400);
    --color-info: var(--color-gray-300);
    --color-focus-ring: rgba(var(--color-teal-300-rgb), 0.4);
    --color-btn-primary-text: var(--color-slate-900);
    --color-card-border: rgba(var(--color-gray-400-rgb), 0.2);
    --color-card-border-inner: rgba(var(--color-gray-400-rgb), 0.15);
  }
}

@font-face {
  font-family: 'FKGroteskNeue';
  src: url('https://r2cdn.perplexity.ai/fonts/FKGroteskNeue.woff2') format('woff2');
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: var(--font-family-base);
  background: var(--color-background);
  color: var(--color-text);
  line-height: var(--line-height-normal);
  font-size: var(--font-size-base);
}

.app-container {
  min-height: 100vh;
  padding: var(--space-32);
}

.header {
  text-align: center;
  margin-bottom: var(--space-32);
}

.header h1 {
  font-size: var(--font-size-4xl);
  font-weight: var(--font-weight-bold);
  margin-bottom: var(--space-8);
  color: var(--color-text);
}

.header p {
  font-size: var(--font-size-lg);
  color: var(--color-text-secondary);
}

.steps-indicator {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: var(--space-16);
  margin-bottom: var(--space-32);
}

.step {
  display: flex;
  align-items: center;
  gap: var(--space-8);
}

.step-circle {
  width: 32px;
  height: 32px;
  border-radius: var(--radius-full);
  background: var(--color-secondary);
  color: var(--color-text-secondary);
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: var(--font-weight-semibold);
  transition: all var(--duration-normal) var(--ease-standard);
}

.step.active .step-circle {
  background: var(--color-primary);
  color: var(--color-btn-primary-text);
}

.step.completed .step-circle {
  background: var(--color-success);
  color: var(--color-btn-primary-text);
}

.step-label {
  font-size: var(--font-size-base);
  color: var(--color-text-secondary);
}

.step.active .step-label {
  color: var(--color-text);
  font-weight: var(--font-weight-medium);
}

.step-divider {
  width: 40px;
  height: 2px;
  background: var(--color-border);
}

.card {
  background: var(--color-surface);
  border-radius: var(--radius-lg);
  padding: var(--space-32);
  box-shadow: var(--shadow-md);
  border: 1px solid var(--color-card-border);
}

.btn {
  padding: var(--space-12) var(--space-24);
  border-radius: var(--radius-base);
  font-size: var(--font-size-base);
  font-weight: var(--font-weight-medium);
  cursor: pointer;
  border: none;
  transition: all var(--duration-normal) var(--ease-standard);
  display: inline-flex;
  align-items: center;
  gap: var(--space-8);
}

.btn-primary {
  background: var(--color-primary);
  color: var(--color-btn-primary-text);
}

.btn-primary:hover {
  background: var(--color-primary-hover);
}

.btn-secondary {
  background: var(--color-secondary);
  color: var(--color-text);
}

.btn-secondary:hover {
  background: var(--color-secondary-hover);
}

.btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
}

.upload-area {
  border: 2px dashed var(--color-border);
  border-radius: var(--radius-lg);
  padding: var(--space-32);
  text-align: center;
  cursor: pointer;
  transition: all var(--duration-normal) var(--ease-standard);
  background: var(--color-bg-1);
}

.upload-area:hover {
  border-color: var(--color-primary);
  background: var(--color-bg-3);
}

.upload-area.dragover {
  border-color: var(--color-primary);
  background: var(--color-bg-3);
}

.table-container {
  overflow-x: auto;
  margin-top: var(--space-24);
  border: 1px solid var(--color-card-border);
  border-radius: var(--radius-base);
}

table {
  width: 100%;
  border-collapse: collapse;
}

th, td {
  padding: var(--space-12);
  text-align: left;
  border-bottom: 1px solid var(--color-card-border-inner);
  font-size: var(--font-size-sm);
}

th {
  background: var(--color-secondary);
  font-weight: var(--font-weight-semibold);
  color: var(--color-text);
}

tr:nth-child(even) {
  background: var(--color-bg-1);
}

tr:hover {
  background: var(--color-bg-2);
}

.form-group {
  margin-bottom: var(--space-20);
}

.form-label {
  display: block;
  margin-bottom: var(--space-8);
  font-weight: var(--font-weight-medium);
  color: var(--color-text);
  font-size: var(--font-size-base);
}

.form-input, .form-textarea, .form-select {
  width: 100%;
  padding: var(--space-12);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-base);
  font-size: var(--font-size-base);
  background: var(--color-surface);
  color: var(--color-text);
  font-family: var(--font-family-base);
}

.form-input:focus, .form-textarea:focus, .form-select:focus {
  outline: var(--focus-outline);
  border-color: var(--color-primary);
}

.form-textarea {
  min-height: 100px;
  resize: vertical;
}

.tab-buttons {
  display: flex;
  gap: var(--space-8);
  margin-bottom: var(--space-16);
  border-bottom: 1px solid var(--color-border);
}

.tab-button {
  padding: var(--space-12) var(--space-20);
  background: transparent;
  border: none;
  border-bottom: 2px solid transparent;
  cursor: pointer;
  font-size: var(--font-size-base);
  color: var(--color-text-secondary);
  transition: all var(--duration-normal) var(--ease-standard);
}

.tab-button.active {
  color: var(--color-primary);
  border-bottom-color: var(--color-primary);
}

.tab-content {
  display: none;
}

.tab-content.active {
  display: block;
}

.grid {
  display: grid;
  gap: var(--space-16);
}

.grid-2 {
  grid-template-columns: repeat(2, 1fr);
}

.grid-3 {
  grid-template-columns: repeat(3, 1fr);
}

.grid-4 {
  grid-template-columns: repeat(4, 1fr);
}

@media (max-width: 1024px) {
  .grid-4 {
    grid-template-columns: repeat(2, 1fr);
  }
}

@media (max-width: 768px) {
  .grid-2, .grid-3, .grid-4 {
    grid-template-columns: 1fr;
  }
}

.stat-card {
  background: var(--color-surface);
  border: 1px solid var(--color-card-border);
  border-radius: var(--radius-lg);
  padding: var(--space-20);
  box-shadow: var(--shadow-sm);
}

.stat-card.bg-1 { background: var(--color-bg-1); }
.stat-card.bg-2 { background: var(--color-bg-2); }
.stat-card.bg-3 { background: var(--color-bg-3); }
.stat-card.bg-4 { background: var(--color-bg-4); }
.stat-card.bg-5 { background: var(--color-bg-5); }
.stat-card.bg-6 { background: var(--color-bg-6); }

.stat-label {
  font-size: var(--font-size-sm);
  color: var(--color-text-secondary);
  margin-bottom: var(--space-4);
}

.stat-value {
  font-size: var(--font-size-3xl);
  font-weight: var(--font-weight-bold);
  color: var(--color-text);
}

.toast {
  position: fixed;
  top: var(--space-20);
  right: var(--space-20);
  padding: var(--space-16) var(--space-20);
  border-radius: var(--radius-base);
  box-shadow: var(--shadow-lg);
  z-index: 1000;
  animation: slideIn 0.3s var(--ease-standard);
}

.toast.success {
  background: var(--color-success);
  color: var(--color-btn-primary-text);
}

.toast.error {
  background: var(--color-error);
  color: var(--color-white);
}

.toast.warning {
  background: var(--color-warning);
  color: var(--color-white);
}

@keyframes slideIn {
  from {
    transform: translateX(100%);
    opacity: 0;
  }
  to {
    transform: translateX(0);
    opacity: 1;
  }
}

.loading-overlay {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0, 0, 0, 0.5);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 999;
}

.loading-content {
  background: var(--color-surface);
  padding: var(--space-32);
  border-radius: var(--radius-lg);
  text-align: center;
}

.spinner {
  width: 48px;
  height: 48px;
  border: 4px solid var(--color-secondary);
  border-top-color: var(--color-primary);
  border-radius: 50%;
  animation: spin 0.8s linear infinite;
  margin: 0 auto var(--space-16);
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

.hidden {
  display: none !important;
}

.button-group {
  display: flex;
  gap: var(--space-12);
  flex-wrap: wrap;
}

.exclude-item, .keyword-item {
  display: flex;
  gap: var(--space-12);
  align-items: flex-start;
  margin-bottom: var(--space-12);
  padding: var(--space-12);
  background: var(--color-bg-1);
  border-radius: var(--radius-base);
}

.exclude-item input, .exclude-item textarea {
  flex: 1;
}

.btn-remove {
  background: var(--color-error);
  color: var(--color-white);
  padding: var(--space-8) var(--space-12);
  border: none;
  border-radius: var(--radius-sm);
  cursor: pointer;
  font-size: var(--font-size-sm);
}

.btn-add {
  background: var(--color-success);
  color: var(--color-btn-primary-text);
  padding: var(--space-8) var(--space-16);
  border: none;
  border-radius: var(--radius-sm);
  cursor: pointer;
  font-size: var(--font-size-sm);
  margin-top: var(--space-8);
}

.checkbox-group {
  display: flex;
  flex-direction: column;
  gap: var(--space-8);
}

.checkbox-label {
  display: flex;
  align-items: center;
  gap: var(--space-8);
  cursor: pointer;
}

.checkbox-label input[type="checkbox"] {
  width: 16px;
  height: 16px;
  cursor: pointer;
}

.two-column {
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: var(--space-24);
}

@media (max-width: 1024px) {
  .two-column {
    grid-template-columns: 1fr;
  }
}

.svg-preview {
  border: 1px solid var(--color-card-border);
  border-radius: var(--radius-lg);
  padding: var(--space-20);
  background: var(--color-surface);
  overflow: auto;
  max-height: 600px;
}

.info-box {
  background: var(--color-bg-2);
  border-left: 4px solid var(--color-warning);
  padding: var(--space-16);
  border-radius: var(--radius-base);
  margin-bottom: var(--space-20);
}

.slider-container {
  display: flex;
  align-items: center;
  gap: var(--space-12);
}

input[type="range"] {
  flex: 1;
  height: 6px;
  background: var(--color-secondary);
  border-radius: var(--radius-full);
  outline: none;
}

input[type="range"]::-webkit-slider-thumb {
  appearance: none;
  width: 18px;
  height: 18px;
  background: var(--color-primary);
  border-radius: 50%;
  cursor: pointer;
}

input[type="range"]::-moz-range-thumb {
  width: 18px;
  height: 18px;
  background: var(--color-primary);
  border-radius: 50%;
  cursor: pointer;
  border: none;
}

.slider-value {
  min-width: 60px;
  text-align: right;
  font-weight: var(--font-weight-medium);
  color: var(--color-text);
}

.actions {
  display: flex;
  justify-content: space-between;
  margin-top: var(--space-32);
  padding-top: var(--space-24);
  border-top: 1px solid var(--color-border);
}

.format-info {
  background: var(--color-bg-1);
  padding: var(--space-20);
  border-radius: var(--radius-lg);
  border: 1px solid var(--color-card-border);
}

.format-badges {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: var(--space-12);
}

.format-badge {
  display: flex;
  align-items: center;
  gap: var(--space-12);
  padding: var(--space-12);
  background: var(--color-surface);
  border-radius: var(--radius-base);
  border: 2px solid var(--color-card-border);
  transition: all var(--duration-normal) var(--ease-standard);
  cursor: help;
}

.format-badge:hover {
  transform: translateY(-2px);
  box-shadow: var(--shadow-md);
}

.format-badge[data-color="blue"] { border-color: #3b82f6; }
.format-badge[data-color="cyan"] { border-color: #06b6d4; }
.format-badge[data-color="red"] { border-color: #ef4444; }
.format-badge[data-color="purple"] { border-color: #a855f7; }
.format-badge[data-color="gray"] { border-color: #6b7280; }
.format-badge[data-color="orange"] { border-color: #f97316; }
.format-badge[data-color="green"] { border-color: #22c55e; }

.format-icon {
  font-size: 28px;
  line-height: 1;
}

.format-name {
  font-weight: var(--font-weight-semibold);
  font-size: var(--font-size-base);
  color: var(--color-text);
}

.format-source {
  font-size: var(--font-size-xs);
  color: var(--color-text-secondary);
  margin-top: 2px;
}

.format-tag {
  display: inline-block;
  padding: var(--space-4) var(--space-12);
  border-radius: var(--radius-sm);
  font-weight: var(--font-weight-medium);
  font-size: var(--font-size-sm);
  background: var(--color-primary);
  color: var(--color-btn-primary-text);
}

.upload-progress {
  margin-top: var(--space-16);
  background: var(--color-surface);
  border-radius: var(--radius-base);
  padding: var(--space-16);
  border: 1px solid var(--color-card-border);
}

.progress-bar {
  height: 8px;
  background: var(--color-secondary);
  border-radius: var(--radius-full);
  overflow: hidden;
  margin-top: var(--space-8);
}

.progress-fill {
  height: 100%;
  background: var(--color-primary);
  transition: width var(--duration-normal) var(--ease-standard);
}

@keyframes successPulse {
  0%, 100% { transform: scale(1); }
  50% { transform: scale(1.05); }
}

.success-animation {
  animation: successPulse 0.6s var(--ease-standard);
}

.theme-selector {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  gap: var(--space-16);
  margin-top: var(--space-16);
}

@media (max-width: 768px) {
  .theme-selector {
    grid-template-columns: 1fr;
  }
}

.theme-option {
  cursor: pointer;
  position: relative;
}

.theme-option input[type="radio"] {
  position: absolute;
  opacity: 0;
  pointer-events: none;
}

.theme-card {
  background: var(--color-surface);
  border: 2px solid var(--color-border);
  border-radius: var(--radius-lg);
  padding: var(--space-20);
  transition: all var(--duration-normal) var(--ease-standard);
  min-height: 140px;
}

.theme-option:hover .theme-card {
  border-color: var(--color-primary);
  transform: translateY(-2px);
  box-shadow: var(--shadow-md);
}

.theme-option input[type="radio"]:checked + .theme-card {
  border-color: var(--color-primary);
  border-width: 3px;
  background: var(--color-bg-3);
  box-shadow: var(--shadow-lg);
}

.theme-title {
  font-size: var(--font-size-lg);
  font-weight: var(--font-weight-bold);
  margin-bottom: var(--space-12);
  color: var(--color-text);
}

.theme-desc {
  font-size: var(--font-size-sm);
  color: var(--color-text);
  margin-bottom: var(--space-4);
  line-height: 1.6;
}

.theme-recommended {
  position: relative;
}

.recommend-badge {
  display: inline-block;
  background: var(--color-success);
  color: var(--color-btn-primary-text);
  padding: 2px 8px;
  border-radius: var(--radius-sm);
  font-size: var(--font-size-xs);
  font-weight: var(--font-weight-bold);
  margin-left: var(--space-8);
}
  </style>
</head>
<body>
  <div class="app-container">
    <div class="header">
      <h1>ğŸ“š PRISMA æ–‡çŒ®ç­›é€‰åŠ©æ‰‹ v1.6</h1>
      <p>åŒäººå®¡æŸ¥åä½œ â€¢ Cohen's Kappaåˆ†æ â€¢ è‡ªåŠ¨åŒ–ç­›é€‰ â€¢ PRISMA 2020æµç¨‹å›¾</p>
      
      <!-- v1.1: Quick access to dual-review mode -->
      <div style="margin-top: var(--space-16); text-align: center;">
        <a href="login.html" style="
          display: inline-block;
          padding: var(--space-8) var(--space-16);
          background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
          color: white;
          text-decoration: none;
          border-radius: var(--radius-lg);
          font-weight: var(--font-weight-semibold);
          font-size: var(--font-size-sm);
          transition: all 0.2s ease;
        " onmouseover="this.style.transform='translateY(-1px)'" onmouseout="this.style.transform='translateY(0)'">
          ğŸ‘¥ åŒäººåä½œå®¡æŸ¥æ¨¡å¼
        </a>
      </div>
    </div>

    <div class="steps-indicator">
      <div class="step active" id="step-indicator-1">
        <div class="step-circle">1</div>
        <span class="step-label">ä¸Šä¼ æ–‡ä»¶</span>
      </div>
      <div class="step-divider"></div>
      <div class="step" id="step-indicator-2">
        <div class="step-circle">2</div>
        <span class="step-label">é…ç½®è§„åˆ™</span>
      </div>
      <div class="step-divider"></div>
      <div class="step" id="step-indicator-3">
        <div class="step-circle">3</div>
        <span class="step-label">åˆæ­¥ç­›é€‰ç»“æœï¼ˆè‡ªåŠ¨ï¼‰</span>
      </div>
      <div class="step-divider"></div>
      <div class="step" id="step-indicator-4">
        <div class="step-circle">4</div>
        <span class="step-label">å…¨æ–‡äººå·¥å®¡æ ¸</span>
      </div>
      <div class="step-divider"></div>
      <div class="step" id="step-indicator-5">
        <div class="step-circle">5</div>
        <span class="step-label">æœ€ç»ˆç»“æœ</span>
      </div>
    </div>

    <!-- Step 1: Upload -->
    <div id="step1" class="card">
      <h2 style="margin-bottom: var(--space-20); font-size: var(--font-size-2xl);">æ­¥éª¤ 1: ä¸Šä¼ æ–‡çŒ®æ•°æ®æ–‡ä»¶</h2>
      
      <!-- v4.0: æ–°æ‰‹å¸®åŠ©é¢æ¿ -->
      <div class="info-box" style="margin-bottom: var(--space-24); background: var(--color-bg-3); border-left: 4px solid var(--color-success);">
        <h3 style="margin-bottom: var(--space-12); font-size: var(--font-size-lg);">ğŸ“ æ–°æ‰‹å…¥é—¨æŒ‡å—</h3>
        <p style="margin-bottom: var(--space-8);"><strong>ç¬¬ä¸€æ¬¡ä½¿ç”¨ï¼Ÿ</strong>æˆ‘ä»¬ä¸ºæ‚¨å‡†å¤‡äº†ï¼š</p>
        <div class="button-group" style="margin-top: var(--space-12);">
          <button class="btn btn-primary" onclick="loadSampleData()" style="background: var(--color-success);">ğŸ“¦ åŠ è½½ç¤ºä¾‹æ•°æ®ï¼ˆä¸€é”®ä½“éªŒï¼‰</button>
          <button class="btn btn-secondary" onclick="toggleDatabaseGuide()">ğŸ“š æ•°æ®åº“å¯¼å‡ºæ•™ç¨‹</button>
          <button class="btn btn-secondary" onclick="showVideoTutorial()">ğŸ¬ è§†é¢‘æ•™ç¨‹</button>
        </div>
      </div>

      <!-- v4.0: æ•°æ®åº“å¯¼å‡ºæ•™ç¨‹ï¼ˆæŠ˜å é¢æ¿ï¼‰ -->
      <div id="databaseGuide" class="hidden" style="margin-bottom: var(--space-24); padding: var(--space-20); background: var(--color-bg-1); border-radius: var(--radius-lg); border: 2px solid var(--color-primary);">
        <h3 style="margin-bottom: var(--space-16); font-size: var(--font-size-xl); color: var(--color-primary);">ğŸ“– å¸¸ç”¨æ•°æ®åº“æ–‡çŒ®å¯¼å‡ºæŒ‡å—</h3>
        
        <details style="margin-bottom: var(--space-16); padding: var(--space-12); background: var(--color-surface); border-radius: var(--radius-base);">
          <summary style="cursor: pointer; font-weight: var(--font-weight-semibold); font-size: var(--font-size-base); padding: var(--space-8);">ğŸ”¬ PubMed å¯¼å‡ºæ­¥éª¤</summary>
          <div style="padding: var(--space-12); margin-top: var(--space-8); border-top: 1px solid var(--color-border);">
            <ol style="padding-left: var(--space-20); line-height: 1.8;">
              <li>åœ¨PubMedæœç´¢æ¡†è¾“å…¥æ£€ç´¢å¼ï¼Œç‚¹å‡»"Search"</li>
              <li>ç‚¹å‡»"Send to"æŒ‰é’®</li>
              <li>é€‰æ‹©"Citation manager"</li>
              <li>ç‚¹å‡»"Create file"ï¼Œä¸‹è½½<strong>.nbibæ–‡ä»¶</strong>ï¼ˆå³RISæ ¼å¼ï¼‰</li>
              <li>å°†ä¸‹è½½çš„æ–‡ä»¶ç›´æ¥æ‹–åˆ°ä¸Šæ–¹ä¸Šä¼ åŒºåŸŸ</li>
            </ol>
            <p style="margin-top: var(--space-12); padding: var(--space-12); background: var(--color-bg-3); border-radius: var(--radius-sm);">ğŸ’¡ <strong>æ¨èæ ¼å¼ï¼š</strong>RIS (.nbib) - åŒ…å«å®Œæ•´æ‘˜è¦å’Œå…³é”®è¯</p>
          </div>
        </details>

        <details style="margin-bottom: var(--space-16); padding: var(--space-12); background: var(--color-surface); border-radius: var(--radius-base);">
          <summary style="cursor: pointer; font-weight: var(--font-weight-semibold); font-size: var(--font-size-base); padding: var(--space-8);">ğŸ“š çŸ¥ç½‘(CNKI) å¯¼å‡ºæ­¥éª¤</summary>
          <div style="padding: var(--space-12); margin-top: var(--space-8); border-top: 1px solid var(--color-border);">
            <ol style="padding-left: var(--space-20); line-height: 1.8;">
              <li>åœ¨çŸ¥ç½‘æ£€ç´¢ç»“æœé¡µé¢ï¼Œå‹¾é€‰è¦å¯¼å‡ºçš„æ–‡çŒ®</li>
              <li>ç‚¹å‡»"å¯¼å‡º/å‚è€ƒæ–‡çŒ®"</li>
              <li>é€‰æ‹©<strong>"Endnote"æ ¼å¼</strong></li>
              <li>ç‚¹å‡»"å¯¼å‡º"ï¼Œä¿å­˜<strong>.enwæ–‡ä»¶</strong></li>
              <li>å°†æ–‡ä»¶ä¸Šä¼ åˆ°æœ¬å·¥å…·</li>
            </ol>
            <p style="margin-top: var(--space-12); padding: var(--space-12); background: var(--color-bg-3); border-radius: var(--radius-sm);">ğŸ’¡ <strong>æ¨èæ ¼å¼ï¼š</strong>Endnote (.enw) - æœ¬å·¥å…·å·²å®Œç¾æ”¯æŒä¸­æ–‡</p>
          </div>
        </details>

        <details style="margin-bottom: var(--space-16); padding: var(--space-12); background: var(--color-surface); border-radius: var(--radius-base);">
          <summary style="cursor: pointer; font-weight: var(--font-weight-semibold); font-size: var(--font-size-base); padding: var(--space-8);">ğŸŒ Web of Science å¯¼å‡ºæ­¥éª¤</summary>
          <div style="padding: var(--space-12); margin-top: var(--space-8); border-top: 1px solid var(--color-border);">
            <ol style="padding-left: var(--space-20); line-height: 1.8;">
              <li>åœ¨æ£€ç´¢ç»“æœé¡µé¢ï¼Œå‹¾é€‰è¦å¯¼å‡ºçš„æ–‡çŒ®ï¼ˆæœ€å¤š500æ¡ï¼‰</li>
              <li>ç‚¹å‡»"å¯¼å‡º"æŒ‰é’®</li>
              <li>æ–‡ä»¶æ ¼å¼é€‰æ‹©<strong>"å…¶ä»–æ–‡ä»¶æ ¼å¼"</strong></li>
              <li>è®°å½•å†…å®¹é€‰æ‹©"å®Œæ•´è®°å½•å’Œå¼•ç”¨çš„å‚è€ƒæ–‡çŒ®"</li>
              <li>æ–‡ä»¶æ ¼å¼é€‰æ‹©<strong>"çº¯æ–‡æœ¬"æˆ–"RIS"</strong></li>
              <li>ç‚¹å‡»"å¯¼å‡º"ï¼Œä¸‹è½½æ–‡ä»¶</li>
            </ol>
            <p style="margin-top: var(--space-12); padding: var(--space-12); background: var(--color-bg-3); border-radius: var(--radius-sm);">ğŸ’¡ <strong>æ¨èæ ¼å¼ï¼š</strong>RIS - æ•°æ®æœ€å®Œæ•´</p>
          </div>
        </details>

        <details style="margin-bottom: var(--space-16); padding: var(--space-12); background: var(--color-surface); border-radius: var(--radius-base);">
          <summary style="cursor: pointer; font-weight: var(--font-weight-semibold); font-size: var(--font-size-base); padding: var(--space-8);">ğŸ“– Cochrane Library å¯¼å‡ºæ­¥éª¤</summary>
          <div style="padding: var(--space-12); margin-top: var(--space-8); border-top: 1px solid var(--color-border);">
            <ol style="padding-left: var(--space-20); line-height: 1.8;">
              <li>æœç´¢å¹¶æ‰“å¼€æ£€ç´¢ç»“æœ</li>
              <li>å‹¾é€‰è¦å¯¼å‡ºçš„æ–‡çŒ®</li>
              <li>ç‚¹å‡»"Export selected"</li>
              <li>é€‰æ‹©<strong>"RIS"æ ¼å¼</strong></li>
              <li>ä¸‹è½½å¹¶ä¸Šä¼ æ–‡ä»¶</li>
            </ol>
          </div>
        </details>

        <details style="padding: var(--space-12); background: var(--color-surface); border-radius: var(--radius-base);">
          <summary style="cursor: pointer; font-weight: var(--font-weight-semibold); font-size: var(--font-size-base); padding: var(--space-8);">ğŸ”§ ä½¿ç”¨æ–‡çŒ®ç®¡ç†è½¯ä»¶ï¼ˆæ¨èï¼‰</summary>
          <div style="padding: var(--space-12); margin-top: var(--space-8); border-top: 1px solid var(--color-border);">
            <h4 style="margin-bottom: var(--space-8);">ä½¿ç”¨ Zoteroï¼ˆå…è´¹æ¨èï¼‰ï¼š</h4>
            <ol style="padding-left: var(--space-20); line-height: 1.8; margin-bottom: var(--space-16);">
              <li>å°†æ‰€æœ‰æ•°æ®åº“çš„æ–‡çŒ®å¯¼å…¥Zotero</li>
              <li>é€‰ä¸­è¦å¯¼å‡ºçš„æ–‡çŒ®</li>
              <li>å³é”® â†’ "å¯¼å‡ºæ¡ç›®"</li>
              <li>æ ¼å¼é€‰æ‹©<strong>"RIS"</strong></li>
              <li>ä¿å­˜å¹¶ä¸Šä¼ åˆ°æœ¬å·¥å…·</li>
            </ol>
            <p style="padding: var(--space-12); background: var(--color-bg-2); border-radius: var(--radius-sm);">â­ <strong>ä¼˜åŠ¿ï¼š</strong>Zoteroå¯ä»¥è‡ªåŠ¨å»é‡ã€ç®¡ç†æ–‡çŒ®ï¼Œå¤§å¤§æé«˜æ•ˆç‡ï¼</p>
          </div>
        </details>

        <button class="btn btn-secondary" onclick="toggleDatabaseGuide()" style="margin-top: var(--space-12);">âœ– å…³é—­æ•™ç¨‹</button>
      </div>
      
      <div class="format-info" style="margin-bottom: var(--space-24);">
        <h3 style="margin-bottom: var(--space-12); font-size: var(--font-size-lg);">æ”¯æŒçš„æ–‡ä»¶æ ¼å¼</h3>
        <div class="format-badges">
          <div class="format-badge" data-color="red" title="æ¨èï¼šâ­â­â­â­â­">
            <span class="format-icon">ğŸ”–</span>
            <div>
              <div class="format-name">RIS</div>
              <div class="format-source">Endnote, Zotero, Mendeley, PubMed</div>
              <div style="font-size: 10px; color: var(--color-warning);">â­â­â­â­â­</div>
            </div>
          </div>
          <div class="format-badge" data-color="orange" title="æ¨èï¼šâ­â­â­â­â­">
            <span class="format-icon">ğŸ”–</span>
            <div>
              <div class="format-name">ENW <span style="background: var(--color-error); color: white; padding: 2px 6px; border-radius: 4px; font-size: 10px;">NEW</span></div>
              <div class="format-source">çŸ¥ç½‘ CNKI âœ…</div>
              <div style="font-size: 10px; color: var(--color-warning);">â­â­â­â­â­</div>
            </div>
          </div>
          <div class="format-badge" data-color="blue" title="æ¨èï¼šâ­â­â­â­â­">
            <span class="format-icon">ğŸ“Š</span>
            <div>
              <div class="format-name">CSV</div>
              <div class="format-source">Excel, Google Sheets</div>
              <div style="font-size: 10px; color: var(--color-warning);">â­â­â­â­â­</div>
            </div>
          </div>
          <div class="format-badge" data-color="cyan" title="æ¨èï¼šâ­â­â­â­">
            <span class="format-icon">ğŸ“‹</span>
            <div>
              <div class="format-name">TSV</div>
              <div class="format-source">Excelåˆ¶è¡¨ç¬¦ã€æ•°æ®åº“</div>
              <div style="font-size: 10px; color: var(--color-warning);">â­â­â­â­</div>
            </div>
          </div>
          <div class="format-badge" data-color="purple" title="æ¨èï¼šâ­â­â­â­">
            <span class="format-icon">ğŸ”–</span>
            <div>
              <div class="format-name">RDF <span style="background: var(--color-error); color: white; padding: 2px 6px; border-radius: 4px; font-size: 10px;">NEW</span></div>
              <div class="format-source">Zotero RDF/XML</div>
              <div style="font-size: 10px; color: var(--color-warning);">â­â­â­â­</div>
            </div>
          </div>
          <div class="format-badge" data-color="green" title="æ¨èï¼šâ­â­â­â­">
            <span class="format-icon">ğŸ“–</span>
            <div>
              <div class="format-name">BibTeX</div>
              <div class="format-source">Google Scholarã€arXiv</div>
              <div style="font-size: 10px; color: var(--color-warning);">â­â­â­â­</div>
            </div>
          </div>
          <div class="format-badge" data-color="gray" title="æ¨èï¼šâ­â­â­">
            <span class="format-icon">ğŸ“„</span>
            <div>
              <div class="format-name">TXT</div>
              <div class="format-source">ç®€å•æ–‡æœ¬</div>
              <div style="font-size: 10px; color: var(--color-warning);">â­â­â­</div>
            </div>
          </div>
        </div>
      </div>

      <!-- v1.2: éšç§ä¸å®‰å…¨å£°æ˜ -->
      <div class="info-box" style="margin-bottom: var(--space-20); background: linear-gradient(135deg, #10b981 0%, #059669 100%); color: white; border: none;">
        <div style="display: flex; align-items: center; gap: var(--space-12);">
          <div style="font-size: 2rem;">ğŸ›¡ï¸</div>
          <div style="flex: 1;">
            <h4 style="margin: 0 0 var(--space-4) 0; font-size: var(--font-size-base); color: white;">æœ¬åœ°ç¦»çº¿å¤„ç†ï¼Œæ•°æ®ä¸ä¸Šä¼ æœåŠ¡å™¨</h4>
            <p style="margin: 0; font-size: var(--font-size-sm); opacity: 0.9;">
              æ‰€æœ‰æ•°æ®å¤„ç†å‡åœ¨æ‚¨çš„æµè§ˆå™¨æœ¬åœ°å®Œæˆï¼Œç»å¯¹å®‰å…¨ã€‚æ‚¨çš„ç ”ç©¶æ•°æ®ä¿å¯†æ€§å¾—åˆ°å®Œå…¨ä¿éšœã€‚
            </p>
          </div>
        </div>
      </div>

      <div class="upload-area" id="uploadArea">
        <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="margin: 0 auto var(--space-16);">
          <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
          <polyline points="17 8 12 3 7 8"></polyline>
          <line x1="12" y1="3" x2="12" y2="15"></line>
        </svg>
        <p style="font-size: var(--font-size-lg); margin-bottom: var(--space-8);">æ‹–æ‹½æ–‡ä»¶åˆ°æ­¤å¤„ï¼Œæˆ–ç‚¹å‡»ä¸Šä¼ </p>
        <p style="font-size: var(--font-size-sm); color: var(--color-text-secondary);">æ”¯æŒ .csv, .tsv, .ris, .bib, .bibtex, .txt, .enw, .rdf æ ¼å¼</p>
        <input type="file" id="fileInput" multiple accept=".csv,.tsv,.ris,.bib,.bibtex,.txt,.enw,.rdf" style="display: none;">
      </div>

      <div id="uploadInfo" class="hidden" style="margin-top: var(--space-24);">
        <div class="info-box">
          <h3 style="margin-bottom: var(--space-8); font-size: var(--font-size-lg);">ğŸ“Š æ–‡ä»¶ä¿¡æ¯</h3>
          <p><strong>æ–‡ä»¶æ ¼å¼:</strong> <span id="fileFormat" class="format-tag">æœªçŸ¥</span></p>
          <p><strong>æ ¼å¼æ¥æº:</strong> <span id="formatSource">-</span></p>
          <p><strong>æ€»è®°å½•æ•°:</strong> <span id="totalRecords">0</span></p>
          <p><strong>æ£€æµ‹åˆ°çš„åˆ—:</strong> <span id="columnList"></span></p>
          <p style="margin-top: var(--space-8);"><strong>åˆ—åæ˜ å°„:</strong></p>
          <div id="columnMapping" style="margin-top: var(--space-8); font-size: var(--font-size-sm);"></div>
        </div>

        <h3 style="margin: var(--space-24) 0 var(--space-12); font-size: var(--font-size-lg);">æ•°æ®é¢„è§ˆ (å‰ 50 è¡Œ)</h3>
        <div class="table-container">
          <table id="previewTable">
            <thead id="previewTableHead"></thead>
            <tbody id="previewTableBody"></tbody>
          </table>
        </div>

        <div class="actions">
          <button class="btn btn-secondary" onclick="resetApp()">é‡æ–°ä¸Šä¼ </button>
          <button class="btn btn-primary" onclick="goToStep2()">ä¸‹ä¸€æ­¥: é…ç½®è§„åˆ™ â†’</button>
        </div>
      </div>
    </div>

    <!-- Step 2: Rules -->
    <div id="step2" class="card hidden">
      <h2 style="margin-bottom: var(--space-20); font-size: var(--font-size-2xl);">æ­¥éª¤ 2: é…ç½®ç­›é€‰è§„åˆ™</h2>

      <div class="two-column">
        <div>
          <div class="tab-buttons">
            <button class="tab-button active" onclick="switchTab('form')">å¯è§†åŒ–è¡¨å•</button>
            <button class="tab-button" onclick="switchTab('yaml')">YAML ç¼–è¾‘å™¨</button>
            <button class="tab-button" onclick="switchTab('format')">æ ¼å¼è¯´æ˜</button>
            <button class="tab-button" onclick="switchTab('mapping')">å­—æ®µæ˜ å°„</button>
          </div>

          <div id="formTab" class="tab-content active">
            <div class="form-group">
              <label class="form-label" style="font-weight: var(--font-weight-bold);">â° æ—¶é—´çª—å£</label>
              <div class="grid grid-2">
                <div>
                  <label class="form-label" style="font-size: var(--font-size-sm);">èµ·å§‹å¹´ä»½</label>
                  <input type="number" class="form-input" id="startYear" value="2000" min="1900" max="2100">
                </div>
                <div>
                  <label class="form-label" style="font-size: var(--font-size-sm);">ç»“æŸå¹´ä»½</label>
                  <input type="number" class="form-input" id="endYear" value="2030" min="1900" max="2100">
                </div>
              </div>
            </div>

            <div class="form-group" style="border-top: 1px solid var(--color-border); padding-top: var(--space-16); margin-top: var(--space-16);">
              <label class="form-label" style="font-weight: var(--font-weight-bold);">ğŸ“Œ åŒ…å«å…³é”®è¯ (ä»»ä¸€å‘½ä¸­å³å€™é€‰) - ç•™ç©ºè¡¨ç¤ºä¸è¿‡æ»¤</label>
              <div class="info-box" style="margin-bottom: var(--space-12); background: var(--color-bg-3); border-left: 4px solid var(--color-info);">
                <p style="margin: 0; font-size: var(--font-size-sm);">ğŸ’¡ <strong>æç¤ºï¼š</strong>å¦‚æœç•™ç©ºï¼Œå°†ä¿ç•™æ‰€æœ‰æ–‡çŒ®è¿›å…¥ä¸‹ä¸€æ­¥ç­›é€‰ã€‚åªæœ‰å½“æ‚¨æƒ³æŒ‰ç‰¹å®šä¸»é¢˜ç­›é€‰æ—¶ï¼Œæ‰éœ€è¦å¡«å†™å…³é”®è¯ã€‚</p>
              </div>
              <textarea class="form-textarea" id="includeKeywords" rows="5" style="font-size: var(--font-size-sm);" placeholder="è¾“å…¥å…³é”®è¯ï¼Œæ¯è¡Œä¸€ä¸ªã€‚ç•™ç©ºåˆ™ä¸è¿›è¡Œå…³é”®è¯è¿‡æ»¤ã€‚"></textarea>
            </div>

            <div class="form-group" style="border-top: 1px solid var(--color-border); padding-top: var(--space-16); margin-top: var(--space-16);">
              <label class="form-label" style="font-weight: var(--font-weight-bold);">âŒ æ’é™¤å…³é”®è¯åŠç†ç”±</label>
              <div id="excludeList" style="max-height: 250px; overflow-y: auto; margin-bottom: var(--space-12);"></div>
              <button class="btn-add" onclick="addExcludeItem()">+ æ·»åŠ æ’é™¤è§„åˆ™</button>
            </div>

            <div class="form-group" style="border-top: 1px solid var(--color-border); padding-top: var(--space-16); margin-top: var(--space-16);">
              <label class="form-label" style="font-weight: var(--font-weight-bold);">ğŸŒ è¯­è¨€ & å¿…å¡«å­—æ®µ</label>
              <div class="grid grid-2">
                <div>
                  <label style="font-size: var(--font-size-sm); margin-bottom: var(--space-8); display: block; font-weight: var(--font-weight-medium);">å…è®¸çš„è¯­è¨€</label>
                  <div class="checkbox-group">
                    <label class="checkbox-label">
                      <input type="checkbox" value="english" checked> è‹±æ–‡
                    </label>
                    <label class="checkbox-label">
                      <input type="checkbox" value="chinese" checked> ä¸­æ–‡
                    </label>
                  </div>
                </div>
                <div>
                  <label style="font-size: var(--font-size-sm); margin-bottom: var(--space-8); display: block; font-weight: var(--font-weight-medium);">å¿…å¡«å­—æ®µ (è‡³å°‘ä¸€é¡¹)</label>
                  <div class="checkbox-group">
                    <label class="checkbox-label">
                      <input type="checkbox" class="required-field" value="title" checked> Title
                    </label>
                    <label class="checkbox-label">
                      <input type="checkbox" class="required-field" value="abstract" checked> Abstract
                    </label>
                  </div>
                </div>
              </div>
            </div>

            <div class="form-group" style="border-top: 1px solid var(--color-border); padding-top: var(--space-16); margin-top: var(--space-16);">
              <label class="form-label" style="font-weight: var(--font-weight-bold);">âš™ï¸ é«˜çº§å‚æ•°</label>
              <div>
                <label class="form-label" style="font-size: var(--font-size-sm); margin-bottom: var(--space-8);">å…¨æ–‡æ’é™¤æ¯”ä¾‹ (æ¨¡æ‹Ÿæ¯”ä¾‹)</label>
                <div class="slider-container">
                  <input type="range" id="ftExcludeRatio" min="0" max="1" step="0.05" value="0.2">
                  <span class="slider-value" id="ftExcludeValue">20%</span>
                </div>
              </div>
            </div>

            <button class="btn btn-secondary" onclick="loadExampleRules()" style="margin-top: var(--space-16); width: 100%;">ğŸ“‹ åŠ è½½ç¤ºä¾‹è§„åˆ™</button>
          </div>

          <div id="yamlTab" class="tab-content">
            <div class="form-group">
              <label class="form-label">YAML é…ç½®</label>
              <textarea class="form-textarea" id="yamlEditor" rows="20" style="font-family: monospace;"></textarea>
            </div>
            <div class="button-group" style="margin-top: var(--space-12);">
              <button class="btn btn-secondary" onclick="exportYAML()">ğŸ“¥ å¯¼å‡ºYAML</button>
              <button class="btn btn-secondary" onclick="importYAML()">ğŸ“¤ å¯¼å…¥YAML</button>
            </div>
          </div>

          <div id="mappingTab" class="tab-content">
            <h3 style="margin-bottom: var(--space-16); font-size: var(--font-size-lg);">ENW å­—æ®µæ˜ å°„ <span style="background: var(--color-error); color: white; padding: 2px 6px; border-radius: 4px; font-size: 10px; margin-left: 8px;">NEW</span></h3>
            <div class="table-container">
              <table>
                <thead>
                  <tr><th>ENWå­—æ®µ</th><th>å«ä¹‰</th><th>æ˜ å°„åˆ°</th></tr>
                </thead>
                <tbody>
                  <tr><td>TY</td><td>æ–‡çŒ®ç±»å‹</td><td>type</td></tr>
                  <tr><td>AU</td><td>ä½œè€…</td><td>authors</td></tr>
                  <tr><td>T1</td><td>æ ‡é¢˜</td><td>title</td></tr>
                  <tr><td>T2</td><td>æœŸåˆŠ</td><td>journal</td></tr>
                  <tr><td>PY</td><td>å‡ºç‰ˆå¹´</td><td>year</td></tr>
                  <tr><td>DO</td><td>DOI</td><td>doi</td></tr>
                  <tr><td>AB</td><td>æ‘˜è¦</td><td>abstract</td></tr>
                  <tr><td>KW</td><td>å…³é”®è¯</td><td>keywords</td></tr>
                  <tr><td>VL</td><td>å·å·</td><td>volume</td></tr>
                  <tr><td>IS</td><td>æœŸå·</td><td>issue</td></tr>
                </tbody>
              </table>
            </div>

            <h3 style="margin: var(--space-24) 0 var(--space-16); font-size: var(--font-size-lg);">RDF å­—æ®µæ˜ å°„ <span style="background: var(--color-error); color: white; padding: 2px 6px; border-radius: 4px; font-size: 10px; margin-left: 8px;">NEW</span></h3>
            <div class="table-container">
              <table>
                <thead>
                  <tr><th>RDFå­—æ®µ</th><th>å«ä¹‰</th><th>æ˜ å°„åˆ°</th></tr>
                </thead>
                <tbody>
                  <tr><td>dc:title</td><td>æ ‡é¢˜</td><td>title</td></tr>
                  <tr><td>dc:creator</td><td>ä½œè€…</td><td>authors</td></tr>
                  <tr><td>dcterms:issued</td><td>å‘è¡Œå¹´</td><td>year</td></tr>
                  <tr><td>bib:publicationTitle</td><td>æœŸåˆŠ</td><td>journal</td></tr>
                  <tr><td>bib:volume</td><td>å·å·</td><td>volume</td></tr>
                  <tr><td>bib:issue</td><td>æœŸå·</td><td>issue</td></tr>
                  <tr><td>dcterms:abstract</td><td>æ‘˜è¦</td><td>abstract</td></tr>
                </tbody>
              </table>
            </div>

            <div class="info-box" style="margin-top: var(--space-20);">
              <h4 style="margin-bottom: var(--space-8);">ğŸ’¡ æç¤º</h4>
              <p>ENW æ ¼å¼æ˜¯çŸ¥ç½‘ CNKI çš„æ ‡å‡†å¯¼å‡ºæ ¼å¼ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨è¯†åˆ«å¹¶æ˜ å°„å­—æ®µã€‚</p>
              <p style="margin-top: var(--space-8);">RDF æ ¼å¼æ˜¯ Zotero çš„ RDF/XML å¯¼å‡ºæ ¼å¼ï¼Œæ”¯æŒå®Œæ•´çš„å…ƒæ•°æ®ç»“æ„ã€‚</p>
            </div>
          </div>

          <div id="formatTab" class="tab-content">
            <h3 style="margin-bottom: var(--space-16); font-size: var(--font-size-lg);">RIS å­—æ®µè¯´æ˜</h3>
            <div class="table-container">
              <table>
                <thead>
                  <tr><th>RISå­—æ®µ</th><th>å«ä¹‰</th></tr>
                </thead>
                <tbody>
                  <tr><td>TY</td><td>æ–‡çŒ®ç±»å‹</td></tr>
                  <tr><td>AU</td><td>ä½œè€…</td></tr>
                  <tr><td>T1</td><td>æ ‡é¢˜</td></tr>
                  <tr><td>T2</td><td>æœŸåˆŠ</td></tr>
                  <tr><td>PY</td><td>å¹´ä»½</td></tr>
                  <tr><td>DO</td><td>DOI</td></tr>
                  <tr><td>AB</td><td>æ‘˜è¦</td></tr>
                  <tr><td>KW</td><td>å…³é”®è¯</td></tr>
                  <tr><td>VL</td><td>å·å·</td></tr>
                  <tr><td>IS</td><td>æœŸå·</td></tr>
                </tbody>
              </table>
            </div>

            <h3 style="margin: var(--space-24) 0 var(--space-16); font-size: var(--font-size-lg);">BibTeX å­—æ®µè¯´æ˜</h3>
            <div class="table-container">
              <table>
                <thead>
                  <tr><th>BibTeXå­—æ®µ</th><th>å«ä¹‰</th></tr>
                </thead>
                <tbody>
                  <tr><td>title</td><td>æ ‡é¢˜</td></tr>
                  <tr><td>author</td><td>ä½œè€…</td></tr>
                  <tr><td>journal</td><td>æœŸåˆŠ</td></tr>
                  <tr><td>year</td><td>å¹´ä»½</td></tr>
                  <tr><td>doi</td><td>DOI</td></tr>
                  <tr><td>abstract</td><td>æ‘˜è¦</td></tr>
                  <tr><td>keywords</td><td>å…³é”®è¯</td></tr>
                  <tr><td>volume</td><td>å·å·</td></tr>
                  <tr><td>number</td><td>æœŸå·</td></tr>
                </tbody>
              </table>
            </div>

            <h3 style="margin: var(--space-24) 0 var(--space-16); font-size: var(--font-size-lg);">å­—æ®µæ˜ å°„</h3>
            <div class="info-box">
              <p>ç³»ç»Ÿä¼šè‡ªåŠ¨å°†ä¸åŒæ ¼å¼çš„å­—æ®µæ˜ å°„åˆ°æ ‡å‡†å­—æ®µï¼š</p>
              <ul style="margin-top: var(--space-8); padding-left: var(--space-20);">
                <li><strong>title:</strong> RIS(T1/TI) â†’ BibTeX(title) â†’ CSV(title/Title)</li>
                <li><strong>abstract:</strong> RIS(AB) â†’ BibTeX(abstract) â†’ CSV(abstract)</li>
                <li><strong>year:</strong> RIS(PY) â†’ BibTeX(year) â†’ CSV(year)</li>
                <li><strong>authors:</strong> RIS(AU) â†’ BibTeX(author) â†’ CSV(authors)</li>
                <li><strong>journal:</strong> RIS(T2/JO) â†’ BibTeX(journal) â†’ CSV(journal)</li>
                <li><strong>doi:</strong> RIS(DO) â†’ BibTeX(doi) â†’ CSV(doi)</li>
              </ul>
            </div>
          </div>

          <button class="btn btn-secondary" onclick="loadExampleRules()" style="margin-top: var(--space-12);">åŠ è½½ç¤ºä¾‹è§„åˆ™</button>
        </div>

        <div>
          <h3 style="margin-bottom: var(--space-12); font-size: var(--font-size-lg);">æ•°æ®é¢„è§ˆ</h3>
          <div class="table-container" style="max-height: 400px; overflow: auto;">
            <table>
              <thead id="rulesPreviewHead"></thead>
              <tbody id="rulesPreviewBody"></tbody>
            </table>
          </div>
        </div>
      </div>

      <div class="actions">
        <button class="btn btn-secondary" onclick="goToStep1()">â† è¿”å›ä¸Šä¼ </button>
        <button class="btn btn-primary" onclick="startScreening()">å¼€å§‹ç­›é€‰ â†’</button>
      </div>
    </div>

    <!-- Step 3: Results -->
    <div id="step3" class="card hidden">
      <h2 style="margin-bottom: var(--space-12); font-size: var(--font-size-2xl);">æ­¥éª¤ 3: åˆæ­¥ç­›é€‰ç»“æœï¼ˆè‡ªåŠ¨ï¼‰</h2>

      <div class="info-box" style="margin-bottom: var(--space-24); background: var(--color-bg-1); border-left: 4px solid var(--color-info);">
        æœ¬é¡µå±•ç¤ºçš„æ˜¯æ ¹æ®ç­›é€‰è§„åˆ™è‡ªåŠ¨ç”Ÿæˆçš„<strong>åˆæ­¥ç»“æœä¸ PRISMA ç»Ÿè®¡</strong>ã€‚ä¸‹ä¸€æ­¥å°†è¿›å…¥<strong>å…¨æ–‡äººå·¥å®¡æ ¸</strong>ã€‚
      </div>

      <div class="button-group" style="margin-bottom: var(--space-24);">
        <button class="btn btn-secondary" onclick="editRulesAndRerun()">ä¿®æ”¹ç­›é€‰è§„åˆ™å¹¶é‡æ–°è¿è¡Œ</button>
      </div>

      <!-- v4.1: é¡¹ç›®ä¿å­˜/åŠ è½½åŠŸèƒ½ -->
      <div class="info-box" style="margin-bottom: var(--space-24); background: var(--color-bg-5); border-left: 4px solid var(--color-primary);">
        <h3 style="margin-bottom: var(--space-12); font-size: var(--font-size-lg);">ğŸ’¾ é¡¹ç›®ç®¡ç†</h3>
        <p style="margin-bottom: var(--space-12);">ä¿å­˜å½“å‰é¡¹ç›®è¿›åº¦ï¼Œé˜²æ­¢æ„å¤–ä¸¢å¤±æ•°æ®ã€‚ä¸‹æ¬¡å¯ç›´æ¥åŠ è½½ç»§ç»­å·¥ä½œã€‚</p>
        <div class="button-group">
          <button class="btn btn-primary" onclick="saveProject()" style="background: var(--color-success);">ğŸ’¾ ä¿å­˜é¡¹ç›®</button>
          <button class="btn btn-secondary" onclick="loadProject()">ğŸ“‚ åŠ è½½é¡¹ç›®</button>
          <button class="btn btn-secondary" onclick="autoSaveToggle()">âš™ï¸ è‡ªåŠ¨ä¿å­˜ï¼š<span id="autoSaveStatus">å…³é—­</span></button>
        </div>
        <p id="lastSaveTime" style="margin-top: var(--space-8); font-size: var(--font-size-sm); color: var(--color-text-secondary);"></p>
      </div>

      <h3 style="margin-bottom: var(--space-16); font-size: var(--font-size-lg);">PRISMA ç»Ÿè®¡</h3>
      <div class="grid grid-4" id="statsGrid">
        <div class="stat-card bg-1">
          <div class="stat-label">è¯†åˆ« (æ•°æ®åº“)</div>
          <div class="stat-value" id="stat-identified-db">0</div>
        </div>
        <div class="stat-card bg-2">
          <div class="stat-label">è¯†åˆ« (å…¶ä»–æ¥æº)</div>
          <div class="stat-value" id="stat-identified-other">0</div>
        </div>
        <div class="stat-card bg-3">
          <div class="stat-label">å»é‡å</div>
          <div class="stat-value" id="stat-after-dupes">0</div>
          <div class="stat-sublabel">
            <small style="font-size: 0.75rem; opacity: 0.8;">
              <a href="javascript:void(0)" onclick="showDeduplicationSettings()" style="color: inherit; text-decoration: underline;">âš™ï¸ å»é‡è®¾ç½®</a>
            </small>
          </div>
        </div>
        <div class="stat-card bg-4">
          <div class="stat-label">æ ‡é¢˜/æ‘˜è¦ç­›é€‰</div>
          <div class="stat-value" id="stat-screened">0</div>
        </div>
        <div class="stat-card bg-5">
          <div class="stat-label">æ ‡é¢˜/æ‘˜è¦æ’é™¤</div>
          <div class="stat-value" id="stat-excluded-ta">0</div>
        </div>
        <div class="stat-card bg-6">
          <div class="stat-label">å…¨æ–‡è¯„ä¼°</div>
          <div class="stat-value" id="stat-fulltext">0</div>
        </div>
        <div class="stat-card bg-1">
          <div class="stat-label">å…¨æ–‡æ’é™¤</div>
          <div class="stat-value" id="stat-excluded-ft">0</div>
        </div>
        <div class="stat-card bg-3">
          <div class="stat-label">âœ“ æœ€ç»ˆçº³å…¥</div>
          <div class="stat-value" id="stat-included">0</div>
        </div>
      </div>

      <h3 style="margin: var(--space-32) 0 var(--space-16); font-size: var(--font-size-lg);">é¢œè‰²ä¸»é¢˜é€‰æ‹©</h3>
      <div class="info-box" style="margin-bottom: var(--space-24);">
        <p style="margin-bottom: var(--space-12); font-weight: var(--font-weight-semibold);">å½“å‰ç‰ˆæœ¬ï¼šv3.0 - å¤šæ–‡ä»¶ä¸Šä¼ ã€äººå·¥å®¡æ ¸ã€çœŸå®æ•°æ®ç»Ÿè®¡</p>
        <p style="margin-bottom: var(--space-16);">é€‰æ‹©æ‚¨åå¥½çš„æµç¨‹å›¾é¢œè‰²ä¸»é¢˜ï¼š</p>
        
        <div class="theme-selector">
          <label class="theme-option" data-theme="colorful">
            <input type="radio" name="theme" value="colorful" />
            <div class="theme-card">
              <div class="theme-title">ğŸ¨ æ´»åŠ›å½©è‰²</div>
              <div class="theme-desc">âœ“ æ¼”è®²/æ±‡æŠ¥æ¨è</div>
              <div class="theme-desc">âœ“ ç½‘é¡µå±•ç¤ºæœ€ä½³</div>
              <div class="theme-desc" style="color: var(--color-text-secondary);">âœ— é»‘ç™½æ‰“å°æ•ˆæœå·®</div>
            </div>
          </label>
          
          <label class="theme-option" data-theme="blackwhite">
            <input type="radio" name="theme" value="blackwhite" />
            <div class="theme-card">
              <div class="theme-title">âš« é»‘ç™½</div>
              <div class="theme-desc">âœ“ å­¦æœ¯æœŸåˆŠæ¨è</div>
              <div class="theme-desc">âœ“ é»‘ç™½æ‰“å°æœ€ä½³</div>
              <div class="theme-desc" style="color: var(--color-text-secondary);">âœ— ç½‘é¡µæ˜¾å¾—è¿‡æ—¶</div>
            </div>
          </label>
          
          <label class="theme-option" data-theme="subtle">
            <input type="radio" name="theme" value="subtle" checked />
            <div class="theme-card theme-recommended">
              <div class="theme-title">âœ¨ æŸ”å’Œ <span class="recommend-badge">æ¨è</span></div>
              <div class="theme-desc">âœ“ åŒ»å­¦/æ”¿ç­–æ¨è</div>
              <div class="theme-desc">âœ“ å½©è‰²é»‘ç™½éƒ½é€‚é…</div>
              <div class="theme-desc">âœ“ æœ€å®‰å…¨çš„é€‰æ‹©</div>
            </div>
          </label>
        </div>
        
        <button class="btn btn-secondary" onclick="updateThemePreview()" style="margin-top: var(--space-16);">ğŸ”„ æ›´æ–°é¢„è§ˆ</button>
        
        <div style="margin-top: var(--space-16); padding: var(--space-12); background: var(--color-bg-2); border-radius: var(--radius-base);">
          <strong>ğŸ’¡ æç¤ºï¼š</strong> ä¸ç¡®å®šé€‰æ‹©ï¼ŸæŸ”å’Œæ–¹æ¡ˆæœ€å®‰å…¨ âœ“
        </div>
      </div>

      <h3 style="margin: var(--space-32) 0 var(--space-16); font-size: var(--font-size-lg);">PRISMA 2020 æµç¨‹å›¾é¢„è§ˆ</h3>

      <div class="info-box" style="margin-bottom: var(--space-16); background: var(--color-bg-2); border-left: 4px solid var(--color-warning);">
        <div style="font-weight: var(--font-weight-semibold); margin-bottom: var(--space-8);">PRISMA å¯¼å‡ºæ¨¡å¼</div>
        <label style="display: inline-flex; align-items: center; gap: var(--space-8); margin-right: var(--space-16);">
          <input type="radio" name="prismaMode" value="simple" />
          ç®€åŒ–ç‰ˆ PRISMA æµç¨‹å›¾ï¼ˆæ•™å­¦/å†…éƒ¨æ±‡æŠ¥ï¼‰
        </label>
        <label style="display: inline-flex; align-items: center; gap: var(--space-8);">
          <input type="radio" name="prismaMode" value="prisma2020" checked />
          æ ‡å‡†åŒ– PRISMA 2020 æµç¨‹å›¾ï¼ˆæŠ•ç¨¿æ¨èï¼‰
        </label>
      </div>

      <div class="svg-preview" id="svgPreview"></div>

      <div id="filterRulesOverview" style="margin-top: var(--space-16);"></div>

      <h3 style="margin: var(--space-32) 0 var(--space-16); font-size: var(--font-size-lg);">ä¸‹è½½ç»“æœæ–‡ä»¶</h3>
      
      <div class="info-box" style="margin-bottom: var(--space-20);">
        <h4 style="margin-bottom: var(--space-12); font-size: var(--font-size-base);">ğŸ“ å¯ä¸‹è½½æ–‡ä»¶è¯´æ˜</h4>
        <p><strong>Excel æ–‡ä»¶ï¼š</strong> é‡‡ç”¨ UTF-8 with BOM ç¼–ç ï¼ŒExcel å¯ç›´æ¥æ‰“å¼€ï¼Œæ— éœ€æ‰‹åŠ¨æŒ‡å®šç¼–ç </p>
        <p style="margin-top: var(--space-8);"><strong>æµç¨‹å›¾ï¼š</strong> æä¾› 3 ä¸ªé¢œè‰²ä¸»é¢˜ç‰ˆæœ¬ï¼ˆå½©è‰²ã€é»‘ç™½ã€æŸ”å’Œï¼‰ï¼Œæ ¹æ®ä½¿ç”¨åœºæ™¯é€‰æ‹©</p>
        <p style="margin-top: var(--space-8); color: var(--color-success); font-weight: var(--font-weight-medium);">âœ… ä¸­æ–‡æ˜¾ç¤ºå®Œç¾ï¼Œæ°¸ä¹…è§£å†³ä¹±ç é—®é¢˜</p>
      </div>

      <div style="margin-bottom: var(--space-16);">
        <h4 style="margin-bottom: var(--space-12); font-size: var(--font-size-base); font-weight: var(--font-weight-semibold);">ã€æ¨èã€‘æ•°æ®æ–‡ä»¶</h4>
        <div class="button-group">
          <button class="btn btn-primary" onclick="downloadFile('included')">ğŸ“¥ ä¸‹è½½ - çº³å…¥ç ”ç©¶ (Excel)</button>
          <button class="btn btn-primary" onclick="downloadFile('excluded')">ğŸ“¥ ä¸‹è½½ - æ’é™¤ç ”ç©¶ (Excel)</button>
        </div>
        <p style="font-size: var(--font-size-sm); color: var(--color-text-secondary); margin-top: var(--space-8);">æ‰€æœ‰æ–‡ä»¶å‡ä¸º UTF-8 ç¼–ç ï¼ŒExcel å¯ç›´æ¥æ‰“å¼€ï¼Œæ— éœ€æ‰‹åŠ¨æŒ‡å®šç¼–ç </p>
      </div>

      <div style="margin-bottom: var(--space-16);">
        <h4 style="margin-bottom: var(--space-12); font-size: var(--font-size-base); font-weight: var(--font-weight-semibold);">ã€æµç¨‹å›¾ã€‘PRISMA å›¾è¡¨</h4>
        <div class="button-group">
          <button class="btn btn-primary" onclick="downloadFile('svg-colorful')">ğŸ“¥ ä¸‹è½½ - PRISMA æµç¨‹å›¾ï¼ˆå½©è‰²ç‰ˆï¼‰</button>
          <button class="btn btn-primary" onclick="downloadFile('svg-blackwhite')">ğŸ“¥ ä¸‹è½½ - PRISMA æµç¨‹å›¾ï¼ˆé»‘ç™½ç‰ˆï¼‰</button>
          <button class="btn btn-primary" onclick="downloadFile('svg-subtle')" style="border: 2px solid var(--color-success);">ğŸ“¥ ä¸‹è½½ - PRISMA æµç¨‹å›¾ï¼ˆæŸ”å’Œç‰ˆï¼‰<span style="margin-left: 8px; font-size: 11px;">â† æ¨è</span></button>
        </div>
        <p style="font-size: var(--font-size-sm); color: var(--color-text-secondary); margin-top: var(--space-8);">å½“å‰é€‰æ‹©ï¼š<span id="currentThemeLabel" style="font-weight: var(--font-weight-semibold); color: var(--color-primary);">æŸ”å’Œç‰ˆ</span></p>
      </div>

      <div style="margin-bottom: var(--space-16);">
        <h4 style="margin-bottom: var(--space-12); font-size: var(--font-size-base); font-weight: var(--font-weight-semibold);">ã€å…¶ä»–ã€‘è¾…åŠ©æ–‡ä»¶</h4>
        <div class="button-group">
          <button class="btn btn-secondary" onclick="downloadFile('report')">ğŸ“¥ ä¸‹è½½ - ç­›é€‰æŠ¥å‘Š (Markdown)</button>
          <button class="btn btn-secondary" onclick="downloadAllFiles()">ğŸ“¦ ä¸‹è½½ - æ‰€æœ‰æ–‡ä»¶</button>
        </div>
      </div>

      <div class="info-box" style="background: var(--color-bg-3); border-left: 4px solid var(--color-success);">
        <h4 style="margin-bottom: var(--space-12); font-size: var(--font-size-base);">ğŸ¨ é¢œè‰²ä¸»é¢˜å»ºè®®</h4>
        <ul style="margin: 0; padding-left: var(--space-20); line-height: 1.8;">
          <li><strong>æŠ•ç¨¿åŒ»å­¦æœŸåˆŠ</strong> â†’ é»‘ç™½ç‰ˆ</li>
          <li><strong>å­¦æœ¯æ±‡æŠ¥æ¼”è®²</strong> â†’ å½©è‰²ç‰ˆ</li>
          <li><strong>ä¸ç¡®å®šé€‰æ‹©</strong> â†’ æŸ”å’Œç‰ˆï¼ˆæ¨è âœ“ï¼‰</li>
        </ul>
      </div>

      <div class="actions">
        <button class="btn btn-secondary" onclick="resetApp()">ğŸ”„ é‡æ–°å¼€å§‹</button>
        <button class="btn btn-primary" id="btnGoStep4" onclick="goToStep4()">ä¸‹ä¸€æ­¥: äººå·¥å®¡æ ¸ â†’</button>
      </div>
    </div>

    <!-- Step 4: Fulltext Manual Review (v1.1) -->
    <div id="step4" class="card hidden">
      <h2 style="margin-bottom: var(--space-20); font-size: var(--font-size-2xl);">æ­¥éª¤ 4: å…¨æ–‡äººå·¥å®¡æ ¸ï¼ˆæœ€ç»ˆï¼‰</h2>
      
      <!-- v1.1: å¤šç”¨æˆ·åä½œä¿¡æ¯ -->
      <div class="info-box" style="margin-bottom: var(--space-24); background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none;">
        <h3 style="margin-bottom: var(--space-16); font-size: var(--font-size-lg); color: white;">ğŸ‘¥ å¤šç”¨æˆ·åä½œå®¡æŸ¥</h3>
        <div id="collaboration-status" class="grid grid-2" style="margin-bottom: var(--space-16);">
          <div style="background: rgba(255,255,255,0.1); padding: var(--space-12); border-radius: 8px;">
            <div style="font-weight: bold; margin-bottom: 4px;">ğŸ‘¨â€ğŸ”¬ ä¸»å®¡æŸ¥å‘˜</div>
            <div id="reviewer-a-status">åŠ è½½ä¸­...</div>
          </div>
          <div style="background: rgba(255,255,255,0.1); padding: var(--space-12); border-radius: 8px;">
            <div style="font-weight: bold; margin-bottom: 4px;">ğŸ‘©â€ğŸ”¬ å‰¯å®¡æŸ¥å‘˜</div>
            <div id="reviewer-b-status">åŠ è½½ä¸­...</div>
          </div>
        </div>
        <div class="button-group">
          <button class="btn" onclick="saveProjectFile()" style="background: rgba(255,255,255,0.2); color: white; border: 1px solid rgba(255,255,255,0.3);">
            ğŸ’¾ å¯¼å‡ºåä½œé¡¹ç›®
          </button>
          <button class="btn" onclick="showProjectStatus()" style="background: rgba(255,255,255,0.2); color: white; border: 1px solid rgba(255,255,255,0.3);">
            ğŸ“Š æŸ¥çœ‹è¯¦ç»†çŠ¶æ€
          </button>
        </div>
        <p style="margin: var(--space-12) 0 0; font-size: var(--font-size-sm); color: rgba(255,255,255,0.9);">
          ğŸ’¡ æ¯ä½å®¡æŸ¥å‘˜åœ¨ç‹¬ç«‹çš„æµè§ˆå™¨ä¼šè¯ä¸­è¿›è¡Œå®¡æŸ¥ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨åŒæ­¥æ•°æ®å¹¶è®¡ç®—ä¸€è‡´æ€§æŒ‡æ ‡
        </p>
      </div>

      <!-- v1.1: ä¸€è‡´æ€§åˆ†æé¢æ¿ -->
      <div id="kappa-analysis" class="info-box hidden" style="margin-bottom: var(--space-24);">
        <h3 style="margin-bottom: var(--space-16); font-size: var(--font-size-lg);">ğŸ“Š å®¡æŸ¥å‘˜é—´ä¸€è‡´æ€§åˆ†æ</h3>
        <div id="kappa-results" class="grid grid-3"></div>
        <button class="btn btn-primary" onclick="showDisagreements()" style="margin-top: var(--space-12);">
          ğŸ” æŸ¥çœ‹æ„è§åˆ†æ­§æ–‡çŒ® (<span id="disagreement-count">0</span>ç¯‡)
        </button>
      </div>
      
      <div class="info-box">
        <h3 style="margin-bottom: var(--space-12); font-size: var(--font-size-lg);">å®¡æ ¸è¯´æ˜</h3>
        <p>å…±<strong id="fulltext-total">0</strong>ç¯‡æ–‡çŒ®éœ€è¦äººå·¥å®¡æ ¸ã€‚è¯·é€ç¯‡æŸ¥é˜…å…¨æ–‡ï¼Œè®°å½•æ’é™¤åŸå› ï¼ˆå¦‚æœ‰ï¼‰ã€‚</p>
      </div>

      <!-- v1.3: ç ”ç©¶æ–¹æ³•è‡ªåŠ¨è¯†åˆ« -->
      <div class="info-box" style="margin: var(--space-24) 0; background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); color: white; border: none;">
        <div style="display: flex; align-items: center; gap: var(--space-12); margin-bottom: var(--space-12);">
          <span style="font-size: 1.5rem;">ğŸ¤–</span>
          <div style="flex: 1;">
            <h3 style="margin: 0 0 var(--space-4) 0; font-size: var(--font-size-lg); color: white;">æ™ºèƒ½è¯†åˆ«ç ”ç©¶æ–¹æ³•</h3>
            <p style="margin: 0; font-size: var(--font-size-sm); opacity: 0.9;">
              åŸºäºæ ‡é¢˜å’Œæ‘˜è¦è‡ªåŠ¨è¯†åˆ«ç ”ç©¶è®¾è®¡ç±»å‹ï¼ˆRCTã€é˜Ÿåˆ—ã€ç—…ä¾‹å¯¹ç…§ç­‰ï¼‰
            </p>
          </div>
          <button class="btn" onclick="autoIdentifyStudyDesigns()" style="background: white; color: #f5576c; font-weight: bold; white-space: nowrap;">
            âœ¨ ä¸€é”®è¯†åˆ«
          </button>
        </div>
        <div style="font-size: var(--font-size-sm); opacity: 0.9; padding: var(--space-8); background: rgba(0,0,0,0.1); border-radius: 4px;">
          âš ï¸ <strong>é‡è¦æç¤ºï¼š</strong>ç ”ç©¶æ–¹æ³•è¯†åˆ«ä¸ºè‡ªåŠ¨å»ºè®®ç»“æœï¼Œä»…ä¾›å‚è€ƒï¼Œè¯·åœ¨å…¨æ–‡æ ¸å¯¹åç¡®è®¤æˆ–ä¿®æ”¹ã€‚
        </div>
      </div>

      <!-- v4.1: æ‰¹é‡æ“ä½œå’Œå¿«æ·é”® -->
      <div class="info-box" style="margin: var(--space-24) 0; background: var(--color-bg-6); border-left: 4px solid var(--color-warning);">
        <h3 style="margin-bottom: var(--space-12); font-size: var(--font-size-lg);">âš¡ å¿«æ·æ“ä½œ</h3>
        <div class="grid grid-2" style="margin-bottom: var(--space-12);">
          <div>
            <h4 style="margin-bottom: var(--space-8); font-size: var(--font-size-base);">æ‰¹é‡æ“ä½œï¼š</h4>
            <div class="button-group">
              <button class="btn btn-secondary" onclick="selectAllRecords()">â˜‘ï¸ å…¨é€‰</button>
              <button class="btn btn-secondary" onclick="deselectAllRecords()">â¬œ å–æ¶ˆå…¨é€‰</button>
              <button class="btn btn-primary" onclick="batchExclude()" style="background: var(--color-warning);">ğŸ—‘ï¸ æ‰¹é‡æ’é™¤å·²é€‰</button>
            </div>
          </div>
          <div>
            <h4 style="margin-bottom: var(--space-8); font-size: var(--font-size-base);">é”®ç›˜å¿«æ·é”®ï¼š</h4>
            <div style="font-size: var(--font-size-sm); line-height: 1.8;">
              <div><kbd style="padding: 2px 6px; background: var(--color-secondary); border-radius: 4px;">1-6</kbd> å¿«é€Ÿé€‰æ‹©æ’é™¤ç†ç”±</div>
              <div><kbd style="padding: 2px 6px; background: var(--color-secondary); border-radius: 4px;">Space</kbd> è·³è¿‡å½“å‰ï¼ˆä¿ç•™ï¼‰</div>
              <div><kbd style="padding: 2px 6px; background: var(--color-secondary); border-radius: 4px;">â†‘/â†“</kbd> ä¸Šä¸‹åˆ‡æ¢æ–‡çŒ®</div>
            </div>
          </div>
        </div>
        <p style="margin: 0; font-size: var(--font-size-sm); color: var(--color-text-secondary);">ğŸ’¡ æç¤ºï¼šä½¿ç”¨å¿«æ·é”®å¯å¤§å¹…æé«˜å®¡æŸ¥æ•ˆç‡</p>
      </div>

      <div style="display: flex; align-items: center; justify-content: space-between; gap: var(--space-12); margin: var(--space-24) 0 var(--space-12);">
        <h3 style="margin: 0; font-size: var(--font-size-lg);">æ’é™¤åŸå› æ¨¡æ¿</h3>
        <button class="btn btn-secondary" onclick="toggleExclusionTemplateEditor()">âœ ç¼–è¾‘æ¨¡æ¿</button>
      </div>

      <div id="exclusion-template-editor" class="hidden" style="margin-bottom: var(--space-16);">
        <div class="info-box" style="background: var(--color-bg-5); border-left: 4px solid var(--color-primary);">
          <div style="margin-bottom: var(--space-12); color: var(--color-text-secondary); font-size: var(--font-size-sm);">
            æ”¯æŒæŒ‰é¡¹ç›®è‡ªå®šä¹‰ã€‚æ•°å­—é”® <strong>1â€“6</strong> ä»…æ˜ å°„åˆ°æ¨¡æ¿å‰ 6 æ¡ã€‚
          </div>
          <div id="exclusion-template-list" style="display: flex; flex-direction: column; gap: var(--space-8);"></div>
          <div class="button-group" style="margin-top: var(--space-12);">
            <button class="btn btn-secondary" onclick="addExclusionTemplateRow()">+ æ·»åŠ åŸå› </button>
            <button class="btn btn-secondary" onclick="restoreDefaultExclusionTemplate()">æ¢å¤é»˜è®¤æ¨¡æ¿</button>
          </div>
        </div>
      </div>

      <div id="exclusion-template-buttons" class="button-group" style="margin-bottom: var(--space-24);"></div>

      <div id="fulltext-review-table" class="table-container" style="max-height: 600px; overflow-y: auto;"></div>

      <h3 style="margin: var(--space-24) 0 var(--space-12); font-size: var(--font-size-lg);">æ’é™¤ç»Ÿè®¡</h3>
      <div class="grid grid-4">
        <div class="stat-card">
          <div class="stat-label">è·å–å…¨æ–‡</div>
          <div class="stat-value" id="fulltext-obtained">0</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">å·²æ’é™¤</div>
          <div class="stat-value" id="fulltext-excluded">0</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">æœ€ç»ˆçº³å…¥</div>
          <div class="stat-value" id="fulltext-included">0</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">æ’é™¤ç‡</div>
          <div class="stat-value" id="fulltext-rate">0%</div>
        </div>
      </div>

      <div id="exclusion-reasons-summary" style="margin: var(--space-24) 0;"></div>

      <div class="actions">
        <button class="btn btn-secondary" onclick="goToStep3()">â† è¿”å›ç»“æœé¢„è§ˆ</button>
        <button class="btn btn-primary" onclick="finalizeFulltextReview()">å®Œæˆå®¡æ ¸ï¼Œç”Ÿæˆæœ€ç»ˆç»“æœ â†’</button>
      </div>
    </div>

    <!-- Step 5: Final Results -->
    <div id="step5" class="card hidden">
      <h2 style="margin-bottom: var(--space-20); font-size: var(--font-size-2xl);">æ­¥éª¤ 5: æœ€ç»ˆç»“æœ</h2>
      
      <div class="info-box" style="margin-bottom: var(--space-24); background: var(--color-bg-3); border-left: 4px solid var(--color-success);">
        <h3 style="margin-bottom: var(--space-12); font-size: var(--font-size-lg);">âœ… æ–‡çŒ®ç­›é€‰å·²å®Œæˆ</h3>
        <p style="margin-bottom: var(--space-8);">æ­å–œï¼æ‚¨å·²å®Œæˆæ‰€æœ‰ç­›é€‰æ­¥éª¤ã€‚ä»¥ä¸‹æ˜¯æœ€ç»ˆç»Ÿè®¡ç»“æœå’Œå¯ä¸‹è½½çš„æ–‡ä»¶ã€‚</p>
      </div>

      <h3 style="margin: var(--space-32) 0 var(--space-16); font-size: var(--font-size-lg);">ğŸ“Š ç­›é€‰ç»Ÿè®¡æ‘˜è¦</h3>
      
      <div class="grid grid-4" style="margin-bottom: var(--space-32);">
        <div class="stat-card">
          <div class="stat-label">æ•°æ®åº“è¯†åˆ«</div>
          <div class="stat-value" id="stat-identified-db-final">0</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">å…¶ä»–æ¥æº</div>
          <div class="stat-value" id="stat-identified-other-final">0</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">å»é‡å</div>
          <div class="stat-value" id="stat-after-dupes-final">0</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">æ ‡é¢˜/æ‘˜è¦ç­›é€‰</div>
          <div class="stat-value" id="stat-screened-final">0</div>
        </div>
      </div>

      <div class="grid grid-4" style="margin-bottom: var(--space-32);">
        <div class="stat-card">
          <div class="stat-label">æ ‡é¢˜/æ‘˜è¦æ’é™¤</div>
          <div class="stat-value" id="stat-excluded-ta-final">0</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">å…¨æ–‡è¯„ä¼°</div>
          <div class="stat-value" id="stat-fulltext-final">0</div>
        </div>
        <div class="stat-card">
          <div class="stat-label">å…¨æ–‡æ’é™¤</div>
          <div class="stat-value" id="stat-excluded-ft-final">0</div>
        </div>
        <div class="stat-card" style="background: var(--color-bg-3); border: 2px solid var(--color-success);">
          <div class="stat-label" style="color: var(--color-success); font-weight: var(--font-weight-bold);">âœ“ æœ€ç»ˆçº³å…¥</div>
          <div class="stat-value" style="color: var(--color-success); font-size: var(--font-size-4xl);" id="stat-included-final">0</div>
        </div>
      </div>

      <div class="info-box" style="margin-bottom: var(--space-24);">
        <p style="margin-bottom: var(--space-12); font-weight: var(--font-weight-semibold);">å½“å‰ç‰ˆæœ¬ï¼šv1.6 - å·¥ç¨‹åŒ–å¢å¼ºï¼ˆè¿›åº¦å¯è§†åŒ–ã€å®¹é”™æœºåˆ¶ã€å»é‡å¯è§£é‡Šã€Kappaåˆ†ææ¢å¤ï¼‰</p>
        <p style="margin-bottom: var(--space-16);">é€‰æ‹©æ‚¨åå¥½çš„æµç¨‹å›¾é¢œè‰²ä¸»é¢˜ï¼š</p>
        
        <div class="theme-selector">
          <label class="theme-option" data-theme="colorful">
            <input type="radio" name="themeFinal" value="colorful" />
            <div class="theme-card">
              <div class="theme-title">ğŸ¨ æ´»åŠ›å½©è‰²</div>
              <div class="theme-desc">âœ“ æ¼”è®²/æ±‡æŠ¥æ¨è</div>
              <div class="theme-desc">âœ“ ç½‘é¡µå±•ç¤ºæœ€ä½³</div>
              <div class="theme-desc" style="color: var(--color-text-secondary);">âœ— é»‘ç™½æ‰“å°æ•ˆæœå·®</div>
            </div>
          </label>
          
          <label class="theme-option" data-theme="blackwhite">
            <input type="radio" name="themeFinal" value="blackwhite" />
            <div class="theme-card">
              <div class="theme-title">âš« é»‘ç™½</div>
              <div class="theme-desc">âœ“ å­¦æœ¯æœŸåˆŠæ¨è</div>
              <div class="theme-desc">âœ“ é»‘ç™½æ‰“å°æœ€ä½³</div>
              <div class="theme-desc" style="color: var(--color-text-secondary);">âœ— ç½‘é¡µæ˜¾å¾—è¿‡æ—¶</div>
            </div>
          </label>
          
          <label class="theme-option" data-theme="subtle">
            <input type="radio" name="themeFinal" value="subtle" checked />
            <div class="theme-card theme-recommended">
              <div class="theme-title">âœ¨ æŸ”å’Œ <span class="recommend-badge">æ¨è</span></div>
              <div class="theme-desc">âœ“ åŒ»å­¦/æ”¿ç­–æ¨è</div>
              <div class="theme-desc">âœ“ å½©è‰²é»‘ç™½éƒ½é€‚é…</div>
              <div class="theme-desc">âœ“ æœ€å®‰å…¨çš„é€‰æ‹©</div>
            </div>
          </label>
        </div>
        
        <button class="btn btn-secondary" onclick="updateThemePreviewFinal()" style="margin-top: var(--space-16);">ğŸ”„ æ›´æ–°é¢„è§ˆ</button>
        
        <div style="margin-top: var(--space-16); padding: var(--space-12); background: var(--color-bg-2); border-radius: var(--radius-base);">
          <strong>ğŸ’¡ æç¤ºï¼š</strong> ä¸ç¡®å®šé€‰æ‹©ï¼ŸæŸ”å’Œæ–¹æ¡ˆæœ€å®‰å…¨ âœ“
        </div>
      </div>

      <h3 style="margin: var(--space-32) 0 var(--space-16); font-size: var(--font-size-lg);">PRISMA 2020 æµç¨‹å›¾é¢„è§ˆ</h3>

      <div class="info-box" style="margin-bottom: var(--space-16); background: var(--color-bg-2); border-left: 4px solid var(--color-warning);">
        <div style="font-weight: var(--font-weight-semibold); margin-bottom: var(--space-8);">PRISMA å¯¼å‡ºæ¨¡å¼</div>
        <label style="display: inline-flex; align-items: center; gap: var(--space-8); margin-right: var(--space-16);">
          <input type="radio" name="prismaModeFinal" value="simple" />
          ç®€åŒ–ç‰ˆ PRISMA æµç¨‹å›¾ï¼ˆæ•™å­¦/å†…éƒ¨æ±‡æŠ¥ï¼‰
        </label>
        <label style="display: inline-flex; align-items: center; gap: var(--space-8);">
          <input type="radio" name="prismaModeFinal" value="prisma2020" checked />
          æ ‡å‡†åŒ– PRISMA 2020 æµç¨‹å›¾ï¼ˆæŠ•ç¨¿æ¨èï¼‰
        </label>
      </div>

      <div class="svg-preview" id="svgPreviewFinal"></div>

      <div id="filterRulesOverviewFinal" style="margin-top: var(--space-16);"></div>

      <h3 style="margin: var(--space-32) 0 var(--space-16); font-size: var(--font-size-lg);">ä¸‹è½½ç»“æœæ–‡ä»¶</h3>
      
      <div class="info-box" style="margin-bottom: var(--space-20);">
        <h4 style="margin-bottom: var(--space-12); font-size: var(--font-size-base);">ğŸ“ å¯ä¸‹è½½æ–‡ä»¶è¯´æ˜</h4>
        <p><strong>Excel æ–‡ä»¶ï¼š</strong> é‡‡ç”¨ UTF-8 with BOM ç¼–ç ï¼ŒExcel å¯ç›´æ¥æ‰“å¼€ï¼Œæ— éœ€æ‰‹åŠ¨æŒ‡å®šç¼–ç </p>
        <p style="margin-top: var(--space-8);"><strong>æµç¨‹å›¾ï¼š</strong> æä¾› 3 ä¸ªé¢œè‰²ä¸»é¢˜ç‰ˆæœ¬ï¼ˆå½©è‰²ã€é»‘ç™½ã€æŸ”å’Œï¼‰ï¼Œæ ¹æ®ä½¿ç”¨åœºæ™¯é€‰æ‹©</p>
        <p style="margin-top: var(--space-8); color: var(--color-success); font-weight: var(--font-weight-medium);">âœ… ä¸­æ–‡æ˜¾ç¤ºå®Œç¾ï¼Œæ°¸ä¹…è§£å†³ä¹±ç é—®é¢˜</p>
      </div>

      <div style="margin-bottom: var(--space-16);">
        <h4 style="margin-bottom: var(--space-12); font-size: var(--font-size-base); font-weight: var(--font-weight-semibold);">ã€æ¨èã€‘æ•°æ®æ–‡ä»¶</h4>
        <div class="button-group">
          <button class="btn btn-primary" onclick="downloadFile('included')">ğŸ“¥ ä¸‹è½½ - çº³å…¥ç ”ç©¶ (Excel)</button>
          <button class="btn btn-primary" onclick="downloadFile('excluded')">ğŸ“¥ ä¸‹è½½ - æ’é™¤ç ”ç©¶ (Excel)</button>
        </div>
        <p style="font-size: var(--font-size-sm); color: var(--color-text-secondary); margin-top: var(--space-8);">æ‰€æœ‰æ–‡ä»¶å‡ä¸º UTF-8 ç¼–ç ï¼ŒExcel å¯ç›´æ¥æ‰“å¼€ï¼Œæ— éœ€æ‰‹åŠ¨æŒ‡å®šç¼–ç </p>
      </div>

      <div style="margin-bottom: var(--space-16);">
        <h4 style="margin-bottom: var(--space-12); font-size: var(--font-size-base); font-weight: var(--font-weight-semibold);">ã€æµç¨‹å›¾ã€‘PRISMA å›¾è¡¨</h4>
        <div class="button-group">
          <button class="btn btn-primary" onclick="downloadFile('svg-colorful')">ğŸ“¥ ä¸‹è½½ - PRISMA æµç¨‹å›¾ï¼ˆå½©è‰²ç‰ˆï¼‰</button>
          <button class="btn btn-primary" onclick="downloadFile('svg-blackwhite')">ğŸ“¥ ä¸‹è½½ - PRISMA æµç¨‹å›¾ï¼ˆé»‘ç™½ç‰ˆï¼‰</button>
          <button class="btn btn-primary" onclick="downloadFile('svg-subtle')" style="border: 2px solid var(--color-success);">ğŸ“¥ ä¸‹è½½ - PRISMA æµç¨‹å›¾ï¼ˆæŸ”å’Œç‰ˆï¼‰<span style="margin-left: 8px; font-size: 11px;">â† æ¨è</span></button>
        </div>
        <p style="font-size: var(--font-size-sm); color: var(--color-text-secondary); margin-top: var(--space-8);">å½“å‰é€‰æ‹©ï¼š<span id="currentThemeLabelFinal" style="font-weight: var(--font-weight-semibold); color: var(--color-primary);">æŸ”å’Œç‰ˆ</span></p>
      </div>

      <div style="margin-bottom: var(--space-16);">
        <h4 style="margin-bottom: var(--space-12); font-size: var(--font-size-base); font-weight: var(--font-weight-semibold);">ã€å…¶ä»–ã€‘è¾…åŠ©æ–‡ä»¶</h4>
        <div class="button-group">
          <button class="btn btn-secondary" onclick="downloadFile('report')">ğŸ“¥ ä¸‹è½½ - ç­›é€‰æŠ¥å‘Š (Markdown)</button>
          <button class="btn btn-secondary" onclick="downloadAllFiles()">ğŸ“¦ ä¸‹è½½ - æ‰€æœ‰æ–‡ä»¶</button>
        </div>
      </div>

      <div class="info-box" style="background: var(--color-bg-3); border-left: 4px solid var(--color-success);">
        <h4 style="margin-bottom: var(--space-12); font-size: var(--font-size-base);">ğŸ¨ é¢œè‰²ä¸»é¢˜å»ºè®®</h4>
        <ul style="margin: 0; padding-left: var(--space-20); line-height: 1.8;">
          <li><strong>æŠ•ç¨¿åŒ»å­¦æœŸåˆŠ</strong> â†’ é»‘ç™½ç‰ˆ</li>
          <li><strong>å­¦æœ¯æ±‡æŠ¥æ¼”è®²</strong> â†’ å½©è‰²ç‰ˆ</li>
          <li><strong>ä¸ç¡®å®šé€‰æ‹©</strong> â†’ æŸ”å’Œç‰ˆï¼ˆæ¨è âœ“ï¼‰</li>
        </ul>
      </div>

      <div class="actions">
        <button class="btn btn-secondary" onclick="resetApp()">ğŸ”„ é‡æ–°å¼€å§‹</button>
        <button class="btn btn-secondary" onclick="goToStep4()">â† è¿”å›äººå·¥å®¡æ ¸</button>
      </div>
    </div>
  </div>

  <!-- v1.5 æ–°å¢ï¼šWeb Worker å’Œè™šæ‹Ÿæ»šåŠ¨ -->
  <script src="virtual-list.js"></script>
  <script>
    // åˆå§‹åŒ– Web Worker
    const dbWorker = new Worker('db-worker.js');
    const parserWorker = new Worker('parser-worker.js');
    
    // åˆ›å»º Promise åŒ…è£…å™¨ï¼Œä¾¿äº async/await è°ƒç”¨
    function workerSend(worker, message) {
      return new Promise((resolve, reject) => {
        const handler = (event) => {
          worker.removeEventListener('message', handler);
          resolve(event.data);
        };
        worker.addEventListener('message', handler);
        worker.postMessage(message);
      });
    }
  </script>
  <script src="app.js"></script>
</body>
</html>
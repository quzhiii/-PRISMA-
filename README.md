# PRISMA 文献筛选助手 v1.7

专为系统综述和 Meta 分析设计的自动化文献筛选工具。支持多源数据导入、智能去重、可视化筛选规则配置，并自动生成 PRISMA 2020 流程图。

🚀 **在线使用**: [GitHub Pages 链接](https://quzhiii.github.io/-PRISMA-/) (需等待部署)

---

## 🔥 v1.7 新特性 (2025-01 Update)

针对用户反馈的痛点，本次更新重点增强了**筛选精准度**和**去重体验**：

### 1. 🛡️ 关键词优先级保护机制
**解决痛点**："排除关键词会误杀包含目标关键词的重要文献"

- **功能**：当一篇文献同时命中"包含关键词"（如 `acupuncture`）和"排除关键词"（如 `protocol`）时，系统会优先保留该文献，不再将其排除。
- **使用**：在 **步骤 2** 的包含关键词输入框下方，勾选 `🛡️ 启用保护机制：包含关键词优先于排除关键词`（默认开启）。
- **效果**：被保护的文献会在筛选结果中标记，确保重要研究不流失。

### 2. 📊 增强型智能去重
**解决痛点**："找不到去重功能，或想单独导出去重后的数据"

- **显式统计**：上传文件后（步骤 1），立即显示醒目的去重统计卡片：
  - 显示原始数量 vs 去重后数量
  - 详细列出 **DOI重复** 和 **标题重复** 的数量
- **独立导出**：新增 **"📥 仅去重导出 (CSV)"** 按钮，无需进行后续筛选即可直接获取清洗后的数据。
- **透明策略**：
  1. **DOI 精确匹配**（最高优先级，跨数据库去重利器）
  2. **标题归一化匹配**（自动忽略标点、大小写、多余空格）

---

## ✨ 核心功能

1. **多格式支持**：
   - ✅ **RIS** (PubMed, Endnote, Zotero)
   - ✅ **CSV / TSV** (Excel, Web of Science)
   - ✅ **NBIB** (PubMed)
   - ✅ **ENW** (CNKI 知网)

2. **自动化筛选流程**：
   - **Step 1**: 智能解析与去重
   - **Step 2**: 灵活配置筛选规则 (时间、关键词、语言、必填项)
   - **Step 3**: 自动筛选结果预览 (包含/排除/去重统计)
   - **Step 4**: 全文人工审查 (记录排除原因：人群/干预/对照/结局不符)
   - **Step 5**: 生成高清 PRISMA 2020 流程图

3. **隐私安全**：
   - 🔒 **纯本地运行**：所有数据处理均在浏览器端完成，**没有任何数据上传到服务器**。安全可靠。

---

## 📖 使用指南

### 1. 启动与上传
打开 `index.html`，将您的文献导出文件（支持批量上传）拖入上传区域。

### 2. 配置规则 (关键步骤)
- **时间窗口**：设定研究年份范围。
- **包含关键词**：输入您的主题词（如 `diabetes`, `insulin`）。任一命中即保留。
- **排除关键词**：输入干扰词（如 `animal`, `review`, `editorial`）。
- **优先级开关**：确认勾选"启用保护机制"，防止误杀。

### 3. 查看结果与导出
- **PRISMA 图**：支持下载 SVG/PNG 格式，直接用于论文发表。
- **Excel 报告**：包含详细的筛选记录，每篇被排除的文章都有具体原因（如"排除了：年份不符"或"排除了：关键词匹配(animal)"）。

---

## ❓ 常见问题 (FAQ)

**Q: 为什么我的文献没有被去重？**  
A: 我们使用 DOI 和归一化标题进行去重。如果两篇文献 DOI 缺失且标题差异较大（如拼写错误），可能无法识别。建议导出时尽量包含 DOI。

**Q: "包含关键词"留空会怎样？**  
A: 如果留空，系统将**保留所有**符合年份和语言要求的文献进入下一步，仅执行排除关键词规则。

**Q: 如何处理 WOS 和 Scopus 的重复数据？**  
A: 直接将两个数据库导出的文件同时拖入上传框。v1.7 会自动执行跨源去重，您可以在 Step 1 直接点击"仅去重导出"获取合并后的数据。

---

## 🛠️ 技术栈
- **核心逻辑**: Vanilla JavaScript (ES6+)
- **界面**: HTML5 + CSS3 (Responsive Grid)
- **解析器**: 自研多格式解析引擎 (RIS/CSV/ENW)
- **依赖**: `js-yaml` (用于规则配置)

---

**开发者**: [quzhiii](https://github.com/quzhiii)  
**许可证**: MIT
